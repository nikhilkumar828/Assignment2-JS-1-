//Data for content
var data = [
    {
        imageSrc: "https://dbjk47w5ep2rm.cloudfront.net/blog/wp-content/uploads/2015/03/Screen-Shot-2015-03-19-at-12.16.37-PM.png",
        postTitle: "Delhi CEO writes to EC over Modi web series",
        postDate: "29th June , 2019",
        postCategory: "BCC",
        postDesc: "Delhi Chief Electoral Officer Ranbir Singh has written to the poll panel saying that a web series on Modi available on the Eros Now website was streaming without certification from the Media Certification and Monitoring Committee (MCMC).A senior official at the Delhi CEO's office reportedly said that they have brought to the notice of the ECI that a series on PM Narendra Modi is being screened on the Eros Now platform without MCMC certification. Since it not a Delhi specific matter, the CEO office has asked the ECI to take cognizance of the matter."
    },
    {
        imageSrc: "https://dbjk47w5ep2rm.cloudfront.net/blog/wp-content/uploads/2015/03/Screen-Shot-2015-03-19-at-12.16.37-PM.png",
        postTitle: "New guidelines to tackle mental health of inmates",
        postDate: "22th June , 2019",
        postCategory: "CNN",
        postDesc: "At present, only Pennsylvania has constituted a detailed manual on mental health for prisoners. Dr Nand Kumar, professor of psychiatry at AIIMS has framed these guidelines on mental health condition for prisoners.Doctors of AII India Institute of Medical Sciences (AIIMS) in collaboration with Delhi Prison Administration have drafted first guidelines on mental health issues for inmates in jail. The manual known as 'Psychological First Aid' will be released on Tuesday."
    },
    {
        imageSrc: "https://dbjk47w5ep2rm.cloudfront.net/blog/wp-content/uploads/2015/03/Screen-Shot-2015-03-19-at-12.16.37-PM.png",
        postTitle: "City ring vowing jobs in Territorial Army busted",
        postDate: "20th June , 2019",
        postCategory: "IndiaToday",
        postDesc: "The fraudsters, police said, have interstate links and they confidently organised physical and medical tests in park adjacent to cantonment area of Bhubaneswar.The entire nexus was unearthed after Delhi crime branch received a complaint from one of the job seeker on April 13. The complainant also given a lead that the accused are coming here in Mahipalpur area of Delhi to distribute admit cards."
    },
    {
        imageSrc: "https://dbjk47w5ep2rm.cloudfront.net/blog/wp-content/uploads/2015/03/Screen-Shot-2015-03-19-at-12.16.37-PM.png",
        postTitle: "Traders' ire to impact election results in Delhi",
        postDate: "20th June , 2019",
        postCategory: "FoxNews",
        postDesc: "The Delhi High Court asked Delhi Pollution Control Committee (DPCC) not to take coercive steps against traders until the next day of hearing on April 26.The violence that rocked the area a month before Delhi votes in the Lok Sabha elections left many wounded on both sides and renewed the old political slugfest over the hot button issue.Since December 2017, about 10,000 commercial establishments have been sealed across the National Capital for land misuse (converting residential units into commercial ones), non-payment of conversion charges and increased pollution emissions."
    },
    {
        imageSrc: "https://dbjk47w5ep2rm.cloudfront.net/blog/wp-content/uploads/2015/03/Screen-Shot-2015-03-19-at-12.16.37-PM.png",
        postTitle: "Ahead of polls, MLA hostel searched in Chennai",
        postDate: "29th June , 2019",
        postCategory: "TV9",
        postDesc: "With just a few days left for the Lok Sabha elections in Tamil Nadu, a team of officials from the flying squad of the Election Commission along with Income Tax officials carried out raids in Tamil Nadu MLA’s Hostel in Omandurar Government Estate.Sources in the IT department said rooms of Tamil Nadu revenue minister RB Udhayakumar and two others were searched. However, it is not clear whether the team seized any cash or incriminating documents from the minister’s room."
    },
    {
        imageSrc: "https://dbjk47w5ep2rm.cloudfront.net/blog/wp-content/uploads/2015/03/Screen-Shot-2015-03-19-at-12.16.37-PM.png",
        postTitle: "Canada drops reference to Sikh extremism from terror threat report",
        postDate: "22th June , 2019",
        postCategory: "Republic",
        postDesc: "Pro-Khalistan group Sikhs for Justice (SFJ) has called upon Canadian Prime Minister Justin Trudeau to step down for practising the politics of expediency in having his government drop Sikh extremism from a report on terror the day before he participated in Baisakhi parade.The damage has been done Mr Prime Minister and you should resign over this, said Gurpatwant Singh Pannun, SFJ legal adviser."
    },
    {
        imageSrc: "https://dbjk47w5ep2rm.cloudfront.net/blog/wp-content/uploads/2015/03/Screen-Shot-2015-03-19-at-12.16.37-PM.png",
        postTitle: "Jet puts off date to resume foreign flights",
        postDate: "20th June , 2019",
        postCategory: "TV5",
        postDesc: "Jet Airways has stopped accepting bookings for its Mumbai-Paris flight until June 10 and closed reservations for its Mumbai-London, Mumbai-Amsterdam-Mumbai and Bangalore-Amsterdam flights, up to April 18.Meanwhile, the airline's pilots who are on the warpath have also decided to defer their strike which was scheduled from Monday as they want to give the airline a chance to survive, keeping in mind the meeting with banks tomorrow."
    },
    {
        imageSrc: "https://dbjk47w5ep2rm.cloudfront.net/blog/wp-content/uploads/2015/03/Screen-Shot-2015-03-19-at-12.16.37-PM.png",
        postTitle: "SP, BJP battle over national security",
        postDate: "20th June , 2019",
        postCategory: "AajTak",
        postDesc: "Prime Minster Narendra Modi also targeted SP-BSP alliance while addressing a rally in Uttar Pradesh's Moradabad district. PM Modi said, The irony is that 'elephant is riding on bicycle for personal gains. They have done nothing for the poor in the state during their regimes, and now they are trying to lure public on fake promises."
    },
    {
        imageSrc: "https://dbjk47w5ep2rm.cloudfront.net/blog/wp-content/uploads/2015/03/Screen-Shot-2015-03-19-at-12.16.37-PM.png",
        postTitle: "Summer assault! Delhi again in big water crisis",
        postDate: "20th June , 2019",
        postCategory: "CNBC",
        postDesc: "The crisis turns so grave that violent fights over water among neighbours in summers are common. Delhi Police said they are gearing up to tackle water clashes that left three dead and many injured last summer.All experts are unanimous that Delhi must revive its water bodies, ensure groundwater recharge through storm drains, store rainwater, and recycle and reuse its waste water."
    },
    {
        imageSrc: "https://dbjk47w5ep2rm.cloudfront.net/blog/wp-content/uploads/2015/03/Screen-Shot-2015-03-19-at-12.16.37-PM.png",
        postTitle: "Melbourne nightclub shooting leaves 1 dead, 3 injured",
        postDate: "20th June , 2019",
        postCategory: "NewsToday",
        postDesc: "Sunday's shooting took place around 3.20 a.m. in the lively entertainment district of Melbourne's southeastern suburb of Prahran, police said.Three security guards and a man queuing to enter were taken to hospital with gunshot injuries, police said in a televised news conference in Melbourne."
    },
];

//Various Categories
var categories = ["All", "BCC", "IndiaToday", "Republic", "TV9", "CNN", "FoxNews", "NewsToday", "AajTak", "CNBC", "TV5"];


//Creation part

//Create Function to create respective element
function createHTMLElement(element, elementId, styleClass, parentElement, HTMLTextOfElement, event, eventFunction) {
    let div = document.createElement(element);
    if (styleClass) {
        div.className = styleClass;
    }
    if (elementId) {
        div.id = elementId;
    }
    if (HTMLTextOfElement) {
        div.innerHTML = HTMLTextOfElement;
    }
    if (event) {
        div.addEventListener(event, eventFunction);
    }
    document.getElementById(parentElement).appendChild(div);
}


//Creates the elements required for the page and adds them
function create() {
    //Adding Header Panel    
    addHeader();
    //Adding body Part
    addMain();
    //Adding Footer Panel
    addFooter();
    //Setting data to the elements
    setData(data);
}


//Header
function addHeader() {

    //Creating and appending div tag
    createHTMLElement('div', 'titleContainer', 'titleMain', 'headerTitle', '', '', '');

    //Creating and appending h2 tag
    createHTMLElement('h2', '', 'titleHeading', 'titleContainer', 'NEWSFEED', '', '');

    //Creating and appending h6 tag
    createHTMLElement('h6', '', 'titleDesc', 'titleContainer', '<i>Yet another newsfeed</i>', '', '');
}

//Body
function addMain() {

    //Creating and appending div tag
    createHTMLElement('div', 'mainContainer', 'flxRow', 'wrapper', '', '', '');

    //Adding popup to be displayed on click of continue reading button
    addPopUp();

    //Creating and appending div tag
    createHTMLElement('div', 'content', 'flxColumn allPosts', 'mainContainer', '', '', '');

    //Creating and appending div tag
    createHTMLElement('div', 'sidePanel', 'sidePanelStyle', 'mainContainer', '', '', '');


    //creation of side panel for adding select category and subscription
    addSidePanel();
}

//sidePanel 
function addSidePanel() {

    //Creating and appending h3 tag
    createHTMLElement('h3', '', '', 'sidePanel', 'Select Category', '', '');

    //ListBox Creation
    //Creating and appending select tag for displaying listBox
    createHTMLElement('select', 'categoryLstBox', 'lstBox', 'sidePanel', '&copy; NewsFeed 2019', 'change', listBoxSelection);

    //Creating and appending option tag for displaying categories
    for (var allCategories = 0; allCategories < categories.length; allCategories++) {
        // Create an Option        
        var opt = document.createElement("option");
        // Add an Option object to List Box
        document.getElementById("categoryLstBox").options.add(opt);
        opt.text = categories[allCategories];
        opt.value = allCategories;
    }

    //Creating and appending div tag 
    createHTMLElement('div', '', '', 'sidePanel', '<br><br>', '', '');

    //Subscribe
    //Creating and appending h3 tag
    createHTMLElement('h3', '', '', 'sidePanel', 'Subscribe<br><br>', '', '');

    //Email
    //Creating and appending form tag for displaying textBox to enter mail 
    createHTMLElement('form', 'emailIdAction', '', 'sidePanel', '', '', '');
    document.getElementById("emailIdAction").action = "#";

    //Creating and appending h5 tag
    createHTMLElement('h5', '', '', 'sidePanel', 'Email Id:<br>', '', '');

    //Creating and appending input tag
    createHTMLElement('input', 'emailIdTextBox', 'txtBoxMeasures', 'sidePanel', '', '', '');
    var thisElement = document.getElementById("emailIdTextBox");
    thisElement.placeHoler = "EmailAddress";
    thisElement.type = "text";

    //Submit Email
    //Creating and appending input tag to create button for submision of mail
    createHTMLElement('input', 'emailIdSubmitBtn', 'btnSubscribe', 'sidePanel', '', 'click', submitEmail);
    thisElement = document.getElementById("emailIdSubmitBtn");
    thisElement.value = "Subscribe";
    thisElement.type = "submit";
}

//Footer
function addFooter() {

    //Creating and appending div tag
    createHTMLElement('div', '', '', 'wrapper', '<br>', '', '');

    //Creating and appending div tag for footer content
    createHTMLElement('div', '', 'marginForFooterContent', 'footerTitle', '&copy; NewsFeed 2019', '', '');
}

function createPost(postNumber, dataArray) {

    //Creating and appending div tag
    createHTMLElement('div', 'post' + postNumber, 'flxRow allPosts', 'content', '', '', '');

    //Creating and appending hr tag
    createHTMLElement('hr', 'postDivisionLine1' + postNumber, 'divideLine', 'content', '', '', '');

    //Creating and appending img tag
    createHTMLElement('img', 'postImageId' + postNumber, 'postImage', 'post' + postNumber, '', '', '');
    document.getElementById("postImageId" + postNumber).src = dataArray[postNumber - 1].imageSrc;

    //Creating and appending div tag
    createHTMLElement('div', 'postContent' + postNumber, 'marginForPost', 'post' + postNumber, '', '', '');

    //Creation of elements inside the postContent 
    //Creating and appending h2 tag to display Post Title
    createHTMLElement('h2', 'postTitleId' + postNumber, '', 'postContent' + postNumber, dataArray[postNumber - 1].postTitle, '', '');

    //Creating and appending h6 tag to display category and date of post
    var titleDescData = "<span class=fontLight>Posted on </span>" + dataArray[postNumber - 1].postDate + "<span class=fontLight>// Category :</span> " + dataArray[postNumber - 1].postCategory;
    createHTMLElement('h6', 'postTitleDescId' + postNumber, 'spacingWithInPosts', 'postContent' + postNumber, titleDescData, '', '');
    document.getElementById("postTitleDescId" + postNumber).value = dataArray[postNumber - 1].postCategory;

    //Creating and appending p tag to display post description
    createHTMLElement('p', 'postDescId' + postNumber, 'spacingWithInPosts', 'postContent' + postNumber, dataArray[postNumber - 1].postDesc, '', '');
    //Creating and appending button tag for displaying popup
    createHTMLElement('button', 'postContinueBtnId' + postNumber, 'postButton spacingWithInPosts', 'postContent' + postNumber, 'Continue Reading', 'click', continueReading);


}

//Setting data and cloning for more posts
function setData(dataToSet) {

    for (let entries = 0; entries < dataToSet.length; entries++) {
        createPost(entries + 1, dataToSet);
    }
}

//to create popup related html elements
function addPopUp() {

    //Creation of div tag
    createHTMLElement('div', 'popUp', 'modal', 'wrapper', '', '', '');

    //Creation of div tag
    createHTMLElement('div', 'popUpContent', 'modal-content', 'popUp', '', '', '');

    //Creation of span tag for close symbol
    createHTMLElement('span', 'closeBtn', 'close', 'popUpContent', '&times;', 'click', popUpCloseBtn);

    //Creation of p tag to display content
    createHTMLElement('p', 'contentDisplayArea', '', 'popUpContent', '', '', '');

}



//Events 

//List Box Selection Event
function listBoxSelection() {

    var selectedData;
    //Getting value selected by user
    let listBox = document.getElementById("categoryLstBox");
    let selectedValue = listBox.value;

    var myNode = document.getElementById("content");
    while (myNode.firstChild) {
        myNode.removeChild(myNode.firstChild);
    }

    if (selectedValue != 0) {
        selectedData = data.filter(function (el) {
            return el.postCategory == categories[selectedValue];
        });

    } else {
        selectedData = data;
    }

    setData(selectedData);


}

//Email submit event
function submitEmail() {
    var arrayOfMailId = [];
    //getting the mailId entered
    let mailId = document.getElementById("emailIdTextBox").value;
    //Regular Expression for email Id
    var re = /\S+@\S+\.\S+/;
    //If mailId is valid then store else show alert
    if (re.test(mailId)) {
        var ids = localStorage.getItem("mailId");
        if (ids) {
            arrayOfMailId = ids.split(',');
        }
        //Storing mailId to localStorage
        arrayOfMailId.push(mailId);
        localStorage.setItem('mailId', JSON.stringify(arrayOfMailId));
        document.getElementById("emailIdTextBox").value = "";
    }
    else {
        alert("Enter Valid Email address");
    }
}

//Continue Reading event
function continueReading() {
    //displaying popup
    document.getElementById("popUp").style.display = "block";

    //getting related text to display
    var btnId = this.id;
    var postId = btnId.substr(btnId.length - 1);
    var title = document.getElementById("postTitleId" + postId).textContent;
    var titleDesc = document.getElementById("postTitleDescId" + postId).textContent;
    var desc = document.getElementById("postDescId" + postId).textContent;

    //Creating and displaying text
    var content = title + "<br><br>" + titleDesc + "<br><br>" + desc + "<br>";
    document.getElementById("contentDisplayArea").innerHTML = content;
}

//popup close event
function popUpCloseBtn() {
    document.getElementById("popUp").style.display = "none";
}